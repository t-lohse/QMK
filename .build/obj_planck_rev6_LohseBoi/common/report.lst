   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 4
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 2
  15              		.file	"report.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "tmk_core/common/report.c"
  20              		.section	.text.has_anykey,"ax",%progbits
  21              		.align	1
  22              		.global	has_anykey
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	has_anykey:
  28              	.LVL0:
  29              	.LFB330:
   1:tmk_core/common/report.c **** /* Copyright 2017 Fred Sundvik
   2:tmk_core/common/report.c ****  *
   3:tmk_core/common/report.c ****  * This program is free software: you can redistribute it and/or modify
   4:tmk_core/common/report.c ****  * it under the terms of the GNU General Public License as published by
   5:tmk_core/common/report.c ****  * the Free Software Foundation, either version 2 of the License, or
   6:tmk_core/common/report.c ****  * (at your option) any later version.
   7:tmk_core/common/report.c ****  *
   8:tmk_core/common/report.c ****  * This program is distributed in the hope that it will be useful,
   9:tmk_core/common/report.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  10:tmk_core/common/report.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  11:tmk_core/common/report.c ****  * GNU General Public License for more details.
  12:tmk_core/common/report.c ****  *
  13:tmk_core/common/report.c ****  * You should have received a copy of the GNU General Public License
  14:tmk_core/common/report.c ****  * along with this program.  If not, see <http://www.gnu.org/licenses/>.
  15:tmk_core/common/report.c ****  */
  16:tmk_core/common/report.c **** 
  17:tmk_core/common/report.c **** #include "report.h"
  18:tmk_core/common/report.c **** #include "host.h"
  19:tmk_core/common/report.c **** #include "keycode_config.h"
  20:tmk_core/common/report.c **** #include "debug.h"
  21:tmk_core/common/report.c **** #include "util.h"
  22:tmk_core/common/report.c **** #include <string.h>
  23:tmk_core/common/report.c **** 
  24:tmk_core/common/report.c **** #ifdef RING_BUFFERED_6KRO_REPORT_ENABLE
  25:tmk_core/common/report.c **** #    define RO_ADD(a, b) ((a + b) % KEYBOARD_REPORT_KEYS)
  26:tmk_core/common/report.c **** #    define RO_SUB(a, b) ((a - b + KEYBOARD_REPORT_KEYS) % KEYBOARD_REPORT_KEYS)
  27:tmk_core/common/report.c **** #    define RO_INC(a)    RO_ADD(a, 1)
  28:tmk_core/common/report.c **** #    define RO_DEC(a)    RO_SUB(a, 1)
  29:tmk_core/common/report.c **** static int8_t cb_head  = 0;
  30:tmk_core/common/report.c **** static int8_t cb_tail  = 0;
  31:tmk_core/common/report.c **** static int8_t cb_count = 0;
  32:tmk_core/common/report.c **** #endif
  33:tmk_core/common/report.c **** 
  34:tmk_core/common/report.c **** /** \brief has_anykey
  35:tmk_core/common/report.c ****  *
  36:tmk_core/common/report.c ****  * FIXME: Needs doc
  37:tmk_core/common/report.c ****  */
  38:tmk_core/common/report.c **** uint8_t has_anykey(report_keyboard_t* keyboard_report) {
  30              		.loc 1 38 56 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		@ link register save eliminated.
  39:tmk_core/common/report.c ****     uint8_t  cnt = 0;
  35              		.loc 1 39 5 view .LVU1
  40:tmk_core/common/report.c ****     uint8_t* p   = keyboard_report->keys;
  36              		.loc 1 40 5 view .LVU2
  41:tmk_core/common/report.c ****     uint8_t  lp  = sizeof(keyboard_report->keys);
  42:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
  43:tmk_core/common/report.c ****     if (keyboard_protocol && keymap_config.nkro) {
  37              		.loc 1 43 9 is_stmt 0 view .LVU3
  38 0000 0B4B     		ldr	r3, .L11
  39              		.loc 1 43 8 view .LVU4
  40 0002 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  40:tmk_core/common/report.c ****     uint8_t* p   = keyboard_report->keys;
  41              		.loc 1 40 14 view .LVU5
  42 0004 821C     		adds	r2, r0, #2
  43              	.LVL1:
  41:tmk_core/common/report.c ****     uint8_t  lp  = sizeof(keyboard_report->keys);
  44              		.loc 1 41 5 is_stmt 1 view .LVU6
  45              		.loc 1 43 5 view .LVU7
  46              		.loc 1 43 8 is_stmt 0 view .LVU8
  47 0006 8BB1     		cbz	r3, .L5
  48              		.loc 1 43 27 discriminator 1 view .LVU9
  49 0008 0A4B     		ldr	r3, .L11+4
  50 000a 93F90030 		ldrsb	r3, [r3]
  44:tmk_core/common/report.c ****         p  = keyboard_report->nkro.bits;
  45:tmk_core/common/report.c ****         lp = sizeof(keyboard_report->nkro.bits);
  46:tmk_core/common/report.c ****     }
  47:tmk_core/common/report.c **** #endif
  48:tmk_core/common/report.c ****     while (lp--) {
  51              		.loc 1 48 14 discriminator 1 view .LVU10
  52 000e 002B     		cmp	r3, #0
  53 0010 ACBF     		ite	ge
  54 0012 0523     		movge	r3, #5
  55 0014 1D23     		movlt	r3, #29
  56              	.L2:
  57              	.LVL2:
  58              		.loc 1 48 14 view .LVU11
  59 0016 0020     		movs	r0, #0
  60              	.LVL3:
  61              	.L4:
  49:tmk_core/common/report.c ****         if (*p++) cnt++;
  62              		.loc 1 49 9 is_stmt 1 view .LVU12
  63              		.loc 1 49 12 is_stmt 0 view .LVU13
  64 0018 12F8011B 		ldrb	r1, [r2], #1	@ zero_extendqisi2
  65              	.LVL4:
  66              		.loc 1 49 12 view .LVU14
  67 001c 09B1     		cbz	r1, .L3
  68              		.loc 1 49 19 is_stmt 1 discriminator 1 view .LVU15
  69              		.loc 1 49 22 is_stmt 0 discriminator 1 view .LVU16
  70 001e 0130     		adds	r0, r0, #1
  71              	.LVL5:
  72              		.loc 1 49 22 discriminator 1 view .LVU17
  73 0020 C0B2     		uxtb	r0, r0
  74              	.LVL6:
  75              	.L3:
  48:tmk_core/common/report.c ****         if (*p++) cnt++;
  76              		.loc 1 48 12 is_stmt 1 view .LVU18
  48:tmk_core/common/report.c ****         if (*p++) cnt++;
  77              		.loc 1 48 14 is_stmt 0 view .LVU19
  78 0022 013B     		subs	r3, r3, #1
  79              	.LVL7:
  48:tmk_core/common/report.c ****         if (*p++) cnt++;
  80              		.loc 1 48 14 view .LVU20
  81 0024 DBB2     		uxtb	r3, r3
  82              	.LVL8:
  48:tmk_core/common/report.c ****         if (*p++) cnt++;
  83              		.loc 1 48 12 view .LVU21
  84 0026 FF2B     		cmp	r3, #255
  85 0028 F6D1     		bne	.L4
  50:tmk_core/common/report.c ****     }
  51:tmk_core/common/report.c ****     return cnt;
  86              		.loc 1 51 5 is_stmt 1 view .LVU22
  52:tmk_core/common/report.c **** }
  87              		.loc 1 52 1 is_stmt 0 view .LVU23
  88 002a 7047     		bx	lr
  89              	.LVL9:
  90              	.L5:
  48:tmk_core/common/report.c ****         if (*p++) cnt++;
  91              		.loc 1 48 14 view .LVU24
  92 002c 0523     		movs	r3, #5
  93 002e F2E7     		b	.L2
  94              	.L12:
  95              		.align	2
  96              	.L11:
  97 0030 00000000 		.word	keyboard_protocol
  98 0034 00000000 		.word	keymap_config
  99              		.cfi_endproc
 100              	.LFE330:
 102              		.section	.text.get_first_key,"ax",%progbits
 103              		.align	1
 104              		.global	get_first_key
 105              		.syntax unified
 106              		.thumb
 107              		.thumb_func
 109              	get_first_key:
 110              	.LVL10:
 111              	.LFB331:
  53:tmk_core/common/report.c **** 
  54:tmk_core/common/report.c **** /** \brief get_first_key
  55:tmk_core/common/report.c ****  *
  56:tmk_core/common/report.c ****  * FIXME: Needs doc
  57:tmk_core/common/report.c ****  */
  58:tmk_core/common/report.c **** uint8_t get_first_key(report_keyboard_t* keyboard_report) {
 112              		.loc 1 58 59 is_stmt 1 view -0
 113              		.cfi_startproc
 114              		@ args = 0, pretend = 0, frame = 0
 115              		@ frame_needed = 0, uses_anonymous_args = 0
  59:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
  60:tmk_core/common/report.c ****     if (keyboard_protocol && keymap_config.nkro) {
 116              		.loc 1 60 5 view .LVU26
  58:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
 117              		.loc 1 58 59 is_stmt 0 view .LVU27
 118 0000 10B5     		push	{r4, lr}
 119              		.cfi_def_cfa_offset 8
 120              		.cfi_offset 4, -8
 121              		.cfi_offset 14, -4
 122              		.loc 1 60 9 view .LVU28
 123 0002 0E4B     		ldr	r3, .L24
 124              		.loc 1 60 8 view .LVU29
 125 0004 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 126 0006 BBB1     		cbz	r3, .L14
 127              		.loc 1 60 27 discriminator 1 view .LVU30
 128 0008 0D4B     		ldr	r3, .L24+4
 129 000a 93F90030 		ldrsb	r3, [r3]
 130 000e 002B     		cmp	r3, #0
 131 0010 12DA     		bge	.L14
 132 0012 421C     		adds	r2, r0, #1
 133              		.loc 1 60 27 view .LVU31
 134 0014 0023     		movs	r3, #0
 135              	.L15:
 136              	.LVL11:
 137              	.LBB2:
  61:tmk_core/common/report.c ****         uint8_t i = 0;
  62:tmk_core/common/report.c ****         for (; i < KEYBOARD_REPORT_BITS && !keyboard_report->nkro.bits[i]; i++)
 138              		.loc 1 62 41 discriminator 2 view .LVU32
 139 0016 12F8011F 		ldrb	r1, [r2, #1]!	@ zero_extendqisi2
 140 001a 41B1     		cbz	r1, .L17
 141 001c DCB2     		uxtb	r4, r3
 142              	.LVL12:
 143              	.L16:
  63:tmk_core/common/report.c ****             ;
  64:tmk_core/common/report.c ****         return i << 3 | biton(keyboard_report->nkro.bits[i]);
 144              		.loc 1 64 9 is_stmt 1 view .LVU33
 145              		.loc 1 64 25 is_stmt 0 view .LVU34
 146 001e 2044     		add	r0, r0, r4
 147              	.LVL13:
 148              		.loc 1 64 25 view .LVU35
 149 0020 8078     		ldrb	r0, [r0, #2]	@ zero_extendqisi2
 150 0022 FFF7FEFF 		bl	biton
 151              	.LVL14:
 152              		.loc 1 64 23 view .LVU36
 153 0026 40EAC400 		orr	r0, r0, r4, lsl #3
 154 002a C0B2     		uxtb	r0, r0
 155              	.L18:
 156              		.loc 1 64 23 view .LVU37
 157              	.LBE2:
  65:tmk_core/common/report.c ****     }
  66:tmk_core/common/report.c **** #endif
  67:tmk_core/common/report.c **** #ifdef RING_BUFFERED_6KRO_REPORT_ENABLE
  68:tmk_core/common/report.c ****     uint8_t i = cb_head;
  69:tmk_core/common/report.c ****     do {
  70:tmk_core/common/report.c ****         if (keyboard_report->keys[i] != 0) {
  71:tmk_core/common/report.c ****             break;
  72:tmk_core/common/report.c ****         }
  73:tmk_core/common/report.c ****         i = RO_INC(i);
  74:tmk_core/common/report.c ****     } while (i != cb_tail);
  75:tmk_core/common/report.c ****     return keyboard_report->keys[i];
  76:tmk_core/common/report.c **** #else
  77:tmk_core/common/report.c ****     return keyboard_report->keys[0];
  78:tmk_core/common/report.c **** #endif
  79:tmk_core/common/report.c **** }
 158              		.loc 1 79 1 view .LVU38
 159 002c 10BD     		pop	{r4, pc}
 160              	.LVL15:
 161              	.L17:
 162              	.LBB3:
  62:tmk_core/common/report.c ****             ;
 163              		.loc 1 62 77 is_stmt 1 discriminator 3 view .LVU39
  62:tmk_core/common/report.c ****             ;
 164              		.loc 1 62 41 discriminator 3 view .LVU40
 165 002e 0133     		adds	r3, r3, #1
 166              	.LVL16:
  62:tmk_core/common/report.c ****             ;
 167              		.loc 1 62 41 is_stmt 0 discriminator 3 view .LVU41
 168 0030 1E2B     		cmp	r3, #30
 169 0032 F0D1     		bne	.L15
 170 0034 1C46     		mov	r4, r3
 171 0036 F2E7     		b	.L16
 172              	.LVL17:
 173              	.L14:
  62:tmk_core/common/report.c ****             ;
 174              		.loc 1 62 41 discriminator 3 view .LVU42
 175              	.LBE3:
  77:tmk_core/common/report.c **** #endif
 176              		.loc 1 77 5 is_stmt 1 view .LVU43
  77:tmk_core/common/report.c **** #endif
 177              		.loc 1 77 33 is_stmt 0 view .LVU44
 178 0038 8078     		ldrb	r0, [r0, #2]	@ zero_extendqisi2
 179              	.LVL18:
  77:tmk_core/common/report.c **** #endif
 180              		.loc 1 77 33 view .LVU45
 181 003a F7E7     		b	.L18
 182              	.L25:
 183              		.align	2
 184              	.L24:
 185 003c 00000000 		.word	keyboard_protocol
 186 0040 00000000 		.word	keymap_config
 187              		.cfi_endproc
 188              	.LFE331:
 190              		.section	.text.is_key_pressed,"ax",%progbits
 191              		.align	1
 192              		.global	is_key_pressed
 193              		.syntax unified
 194              		.thumb
 195              		.thumb_func
 197              	is_key_pressed:
 198              	.LVL19:
 199              	.LFB332:
  80:tmk_core/common/report.c **** 
  81:tmk_core/common/report.c **** /** \brief Checks if a key is pressed in the report
  82:tmk_core/common/report.c ****  *
  83:tmk_core/common/report.c ****  * Returns true if the keyboard_report reports that the key is pressed, otherwise false
  84:tmk_core/common/report.c ****  * Note: The function doesn't support modifers currently, and it returns false for KC_NO
  85:tmk_core/common/report.c ****  */
  86:tmk_core/common/report.c **** bool is_key_pressed(report_keyboard_t* keyboard_report, uint8_t key) {
 200              		.loc 1 86 70 is_stmt 1 view -0
 201              		.cfi_startproc
 202              		@ args = 0, pretend = 0, frame = 0
 203              		@ frame_needed = 0, uses_anonymous_args = 0
 204              		@ link register save eliminated.
  87:tmk_core/common/report.c ****     if (key == KC_NO) {
 205              		.loc 1 87 5 view .LVU47
 206              		.loc 1 87 8 is_stmt 0 view .LVU48
 207 0000 F1B1     		cbz	r1, .L31
  88:tmk_core/common/report.c ****         return false;
  89:tmk_core/common/report.c ****     }
  90:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
  91:tmk_core/common/report.c ****     if (keyboard_protocol && keymap_config.nkro) {
 208              		.loc 1 91 5 is_stmt 1 view .LVU49
 209              		.loc 1 91 9 is_stmt 0 view .LVU50
 210 0002 114B     		ldr	r3, .L38
 211              		.loc 1 91 8 view .LVU51
 212 0004 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 213 0006 9BB1     		cbz	r3, .L28
 214              		.loc 1 91 27 discriminator 1 view .LVU52
 215 0008 104B     		ldr	r3, .L38+4
 216 000a 93F90030 		ldrsb	r3, [r3]
 217 000e 002B     		cmp	r3, #0
 218 0010 0EDA     		bge	.L28
  92:tmk_core/common/report.c ****         if ((key >> 3) < KEYBOARD_REPORT_BITS) {
 219              		.loc 1 92 9 is_stmt 1 view .LVU53
 220              		.loc 1 92 12 is_stmt 0 view .LVU54
 221 0012 EF29     		cmp	r1, #239
 222              		.loc 1 92 24 view .LVU55
 223 0014 4FEAD102 		lsr	r2, r1, #3
 224              		.loc 1 92 12 view .LVU56
 225 0018 12D8     		bhi	.L31
  93:tmk_core/common/report.c ****             return keyboard_report->nkro.bits[key >> 3] & 1 << (key & 7);
 226              		.loc 1 93 13 is_stmt 1 view .LVU57
 227              		.loc 1 93 46 is_stmt 0 view .LVU58
 228 001a 1044     		add	r0, r0, r2
 229              	.LVL20:
 230              		.loc 1 93 69 view .LVU59
 231 001c 01F00701 		and	r1, r1, #7
 232              	.LVL21:
 233              		.loc 1 93 46 view .LVU60
 234 0020 8278     		ldrb	r2, [r0, #2]	@ zero_extendqisi2
 235              		.loc 1 93 61 view .LVU61
 236 0022 0123     		movs	r3, #1
 237 0024 8B40     		lsls	r3, r3, r1
 238              		.loc 1 93 57 view .LVU62
 239 0026 1342     		tst	r3, r2
 240 0028 14BF     		ite	ne
 241 002a 0120     		movne	r0, #1
 242 002c 0020     		moveq	r0, #0
 243 002e 7047     		bx	lr
 244              	.LVL22:
 245              	.L28:
 246              	.LBB4:
  94:tmk_core/common/report.c ****         } else {
  95:tmk_core/common/report.c ****             return false;
  96:tmk_core/common/report.c ****         }
  97:tmk_core/common/report.c ****     }
  98:tmk_core/common/report.c **** #endif
  99:tmk_core/common/report.c ****     for (int i = 0; i < KEYBOARD_REPORT_KEYS; i++) {
 247              		.loc 1 99 23 is_stmt 1 view .LVU63
 248 0030 431C     		adds	r3, r0, #1
 249 0032 0730     		adds	r0, r0, #7
 250              	.LVL23:
 251              	.L29:
 100:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == key) {
 252              		.loc 1 100 9 view .LVU64
 253              		.loc 1 100 12 is_stmt 0 view .LVU65
 254 0034 13F8012F 		ldrb	r2, [r3, #1]!	@ zero_extendqisi2
 255              	.LVL24:
 256              		.loc 1 100 12 view .LVU66
 257 0038 8A42     		cmp	r2, r1
 258 003a 03D0     		beq	.L32
  99:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == key) {
 259              		.loc 1 99 48 is_stmt 1 discriminator 2 view .LVU67
 260              	.LVL25:
  99:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == key) {
 261              		.loc 1 99 23 discriminator 2 view .LVU68
 262 003c 8342     		cmp	r3, r0
 263 003e F9D1     		bne	.L29
 264              	.LVL26:
 265              	.L31:
  99:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == key) {
 266              		.loc 1 99 23 is_stmt 0 discriminator 2 view .LVU69
 267              	.LBE4:
  88:tmk_core/common/report.c ****     }
 268              		.loc 1 88 16 view .LVU70
 269 0040 0020     		movs	r0, #0
 270 0042 7047     		bx	lr
 271              	.LVL27:
 272              	.L32:
 273              	.LBB5:
 101:tmk_core/common/report.c ****             return true;
 274              		.loc 1 101 20 view .LVU71
 275 0044 0120     		movs	r0, #1
 276              	.LVL28:
 277              		.loc 1 101 20 view .LVU72
 278              	.LBE5:
 102:tmk_core/common/report.c ****         }
 103:tmk_core/common/report.c ****     }
 104:tmk_core/common/report.c ****     return false;
 105:tmk_core/common/report.c **** }
 279              		.loc 1 105 1 view .LVU73
 280 0046 7047     		bx	lr
 281              	.L39:
 282              		.align	2
 283              	.L38:
 284 0048 00000000 		.word	keyboard_protocol
 285 004c 00000000 		.word	keymap_config
 286              		.cfi_endproc
 287              	.LFE332:
 289              		.section	.text.add_key_byte,"ax",%progbits
 290              		.align	1
 291              		.global	add_key_byte
 292              		.syntax unified
 293              		.thumb
 294              		.thumb_func
 296              	add_key_byte:
 297              	.LVL29:
 298              	.LFB333:
 106:tmk_core/common/report.c **** 
 107:tmk_core/common/report.c **** /** \brief add key byte
 108:tmk_core/common/report.c ****  *
 109:tmk_core/common/report.c ****  * FIXME: Needs doc
 110:tmk_core/common/report.c ****  */
 111:tmk_core/common/report.c **** void add_key_byte(report_keyboard_t* keyboard_report, uint8_t code) {
 299              		.loc 1 111 69 is_stmt 1 view -0
 300              		.cfi_startproc
 301              		@ args = 0, pretend = 0, frame = 0
 302              		@ frame_needed = 0, uses_anonymous_args = 0
 112:tmk_core/common/report.c **** #ifdef RING_BUFFERED_6KRO_REPORT_ENABLE
 113:tmk_core/common/report.c ****     int8_t i     = cb_head;
 114:tmk_core/common/report.c ****     int8_t empty = -1;
 115:tmk_core/common/report.c ****     if (cb_count) {
 116:tmk_core/common/report.c ****         do {
 117:tmk_core/common/report.c ****             if (keyboard_report->keys[i] == code) {
 118:tmk_core/common/report.c ****                 return;
 119:tmk_core/common/report.c ****             }
 120:tmk_core/common/report.c ****             if (empty == -1 && keyboard_report->keys[i] == 0) {
 121:tmk_core/common/report.c ****                 empty = i;
 122:tmk_core/common/report.c ****             }
 123:tmk_core/common/report.c ****             i = RO_INC(i);
 124:tmk_core/common/report.c ****         } while (i != cb_tail);
 125:tmk_core/common/report.c ****         if (i == cb_tail) {
 126:tmk_core/common/report.c ****             if (cb_tail == cb_head) {
 127:tmk_core/common/report.c ****                 // buffer is full
 128:tmk_core/common/report.c ****                 if (empty == -1) {
 129:tmk_core/common/report.c ****                     // pop head when has no empty space
 130:tmk_core/common/report.c ****                     cb_head = RO_INC(cb_head);
 131:tmk_core/common/report.c ****                     cb_count--;
 132:tmk_core/common/report.c ****                 } else {
 133:tmk_core/common/report.c ****                     // left shift when has empty space
 134:tmk_core/common/report.c ****                     uint8_t offset = 1;
 135:tmk_core/common/report.c ****                     i              = RO_INC(empty);
 136:tmk_core/common/report.c ****                     do {
 137:tmk_core/common/report.c ****                         if (keyboard_report->keys[i] != 0) {
 138:tmk_core/common/report.c ****                             keyboard_report->keys[empty] = keyboard_report->keys[i];
 139:tmk_core/common/report.c ****                             keyboard_report->keys[i]     = 0;
 140:tmk_core/common/report.c ****                             empty                        = RO_INC(empty);
 141:tmk_core/common/report.c ****                         } else {
 142:tmk_core/common/report.c ****                             offset++;
 143:tmk_core/common/report.c ****                         }
 144:tmk_core/common/report.c ****                         i = RO_INC(i);
 145:tmk_core/common/report.c ****                     } while (i != cb_tail);
 146:tmk_core/common/report.c ****                     cb_tail = RO_SUB(cb_tail, offset);
 147:tmk_core/common/report.c ****                 }
 148:tmk_core/common/report.c ****             }
 149:tmk_core/common/report.c ****         }
 150:tmk_core/common/report.c ****     }
 151:tmk_core/common/report.c ****     // add to tail
 152:tmk_core/common/report.c ****     keyboard_report->keys[cb_tail] = code;
 153:tmk_core/common/report.c ****     cb_tail                        = RO_INC(cb_tail);
 154:tmk_core/common/report.c ****     cb_count++;
 155:tmk_core/common/report.c **** #else
 156:tmk_core/common/report.c ****     int8_t i     = 0;
 303              		.loc 1 156 5 view .LVU75
 157:tmk_core/common/report.c ****     int8_t empty = -1;
 304              		.loc 1 157 5 view .LVU76
 158:tmk_core/common/report.c ****     for (; i < KEYBOARD_REPORT_KEYS; i++) {
 305              		.loc 1 158 5 view .LVU77
 306              		.loc 1 158 14 view .LVU78
 111:tmk_core/common/report.c **** #ifdef RING_BUFFERED_6KRO_REPORT_ENABLE
 307              		.loc 1 111 69 is_stmt 0 view .LVU79
 308 0000 30B5     		push	{r4, r5, lr}
 309              		.cfi_def_cfa_offset 12
 310              		.cfi_offset 4, -12
 311              		.cfi_offset 5, -8
 312              		.cfi_offset 14, -4
 111:tmk_core/common/report.c **** #ifdef RING_BUFFERED_6KRO_REPORT_ENABLE
 313              		.loc 1 111 69 view .LVU80
 314 0002 0022     		movs	r2, #0
 315 0004 441C     		adds	r4, r0, #1
 157:tmk_core/common/report.c ****     int8_t empty = -1;
 316              		.loc 1 157 12 view .LVU81
 317 0006 4FF0FF33 		mov	r3, #-1
 318              	.LVL30:
 319              	.L43:
 159:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == code) {
 320              		.loc 1 159 9 is_stmt 1 view .LVU82
 321              		.loc 1 159 34 is_stmt 0 view .LVU83
 322 000a 14F8015F 		ldrb	r5, [r4, #1]!	@ zero_extendqisi2
 323              		.loc 1 159 12 view .LVU84
 324 000e 8D42     		cmp	r5, r1
 325 0010 0BD0     		beq	.L40
 160:tmk_core/common/report.c ****             break;
 161:tmk_core/common/report.c ****         }
 162:tmk_core/common/report.c ****         if (empty == -1 && keyboard_report->keys[i] == 0) {
 326              		.loc 1 162 9 is_stmt 1 view .LVU85
 327              		.loc 1 162 12 is_stmt 0 view .LVU86
 328 0012 B3F1FF3F 		cmp	r3, #-1
 329 0016 01D1     		bne	.L42
 330              		.loc 1 162 25 discriminator 1 view .LVU87
 331 0018 05B9     		cbnz	r5, .L42
 332 001a 53B2     		sxtb	r3, r2
 333              	.LVL31:
 334              	.L42:
 158:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == code) {
 335              		.loc 1 158 39 is_stmt 1 view .LVU88
 158:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == code) {
 336              		.loc 1 158 14 view .LVU89
 337 001c 0132     		adds	r2, r2, #1
 338              	.LVL32:
 158:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == code) {
 339              		.loc 1 158 14 is_stmt 0 view .LVU90
 340 001e 062A     		cmp	r2, #6
 341 0020 F3D1     		bne	.L43
 163:tmk_core/common/report.c ****             empty = i;
 164:tmk_core/common/report.c ****         }
 165:tmk_core/common/report.c ****     }
 166:tmk_core/common/report.c ****     if (i == KEYBOARD_REPORT_KEYS) {
 342              		.loc 1 166 5 is_stmt 1 view .LVU91
 167:tmk_core/common/report.c ****         if (empty != -1) {
 343              		.loc 1 167 9 view .LVU92
 344              		.loc 1 167 12 is_stmt 0 view .LVU93
 345 0022 5A1C     		adds	r2, r3, #1
 346 0024 01D0     		beq	.L40
 168:tmk_core/common/report.c ****             keyboard_report->keys[empty] = code;
 347              		.loc 1 168 13 is_stmt 1 view .LVU94
 348              		.loc 1 168 42 is_stmt 0 view .LVU95
 349 0026 1844     		add	r0, r0, r3
 350              	.LVL33:
 351              		.loc 1 168 42 view .LVU96
 352 0028 8170     		strb	r1, [r0, #2]
 353              	.LVL34:
 354              	.L40:
 169:tmk_core/common/report.c ****         }
 170:tmk_core/common/report.c ****     }
 171:tmk_core/common/report.c **** #endif
 172:tmk_core/common/report.c **** }
 355              		.loc 1 172 1 view .LVU97
 356 002a 30BD     		pop	{r4, r5, pc}
 357              		.cfi_endproc
 358              	.LFE333:
 360              		.section	.text.del_key_byte,"ax",%progbits
 361              		.align	1
 362              		.global	del_key_byte
 363              		.syntax unified
 364              		.thumb
 365              		.thumb_func
 367              	del_key_byte:
 368              	.LVL35:
 369              	.LFB334:
 173:tmk_core/common/report.c **** 
 174:tmk_core/common/report.c **** /** \brief del key byte
 175:tmk_core/common/report.c ****  *
 176:tmk_core/common/report.c ****  * FIXME: Needs doc
 177:tmk_core/common/report.c ****  */
 178:tmk_core/common/report.c **** void del_key_byte(report_keyboard_t* keyboard_report, uint8_t code) {
 370              		.loc 1 178 69 is_stmt 1 view -0
 371              		.cfi_startproc
 372              		@ args = 0, pretend = 0, frame = 0
 373              		@ frame_needed = 0, uses_anonymous_args = 0
 179:tmk_core/common/report.c **** #ifdef RING_BUFFERED_6KRO_REPORT_ENABLE
 180:tmk_core/common/report.c ****     uint8_t i = cb_head;
 181:tmk_core/common/report.c ****     if (cb_count) {
 182:tmk_core/common/report.c ****         do {
 183:tmk_core/common/report.c ****             if (keyboard_report->keys[i] == code) {
 184:tmk_core/common/report.c ****                 keyboard_report->keys[i] = 0;
 185:tmk_core/common/report.c ****                 cb_count--;
 186:tmk_core/common/report.c ****                 if (cb_count == 0) {
 187:tmk_core/common/report.c ****                     // reset head and tail
 188:tmk_core/common/report.c ****                     cb_tail = cb_head = 0;
 189:tmk_core/common/report.c ****                 }
 190:tmk_core/common/report.c ****                 if (i == RO_DEC(cb_tail)) {
 191:tmk_core/common/report.c ****                     // left shift when next to tail
 192:tmk_core/common/report.c ****                     do {
 193:tmk_core/common/report.c ****                         cb_tail = RO_DEC(cb_tail);
 194:tmk_core/common/report.c ****                         if (keyboard_report->keys[RO_DEC(cb_tail)] != 0) {
 195:tmk_core/common/report.c ****                             break;
 196:tmk_core/common/report.c ****                         }
 197:tmk_core/common/report.c ****                     } while (cb_tail != cb_head);
 198:tmk_core/common/report.c ****                 }
 199:tmk_core/common/report.c ****                 break;
 200:tmk_core/common/report.c ****             }
 201:tmk_core/common/report.c ****             i = RO_INC(i);
 202:tmk_core/common/report.c ****         } while (i != cb_tail);
 203:tmk_core/common/report.c ****     }
 204:tmk_core/common/report.c **** #else
 205:tmk_core/common/report.c ****     for (uint8_t i = 0; i < KEYBOARD_REPORT_KEYS; i++) {
 374              		.loc 1 205 5 view .LVU99
 375              	.LBB6:
 376              		.loc 1 205 10 view .LVU100
 377              		.loc 1 205 27 view .LVU101
 378              	.LBE6:
 178:tmk_core/common/report.c **** #ifdef RING_BUFFERED_6KRO_REPORT_ENABLE
 379              		.loc 1 178 69 is_stmt 0 view .LVU102
 380 0000 10B5     		push	{r4, lr}
 381              		.cfi_def_cfa_offset 8
 382              		.cfi_offset 4, -8
 383              		.cfi_offset 14, -4
 384 0002 431C     		adds	r3, r0, #1
 385              	.LBB7:
 206:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == code) {
 207:tmk_core/common/report.c ****             keyboard_report->keys[i] = 0;
 386              		.loc 1 207 38 view .LVU103
 387 0004 0022     		movs	r2, #0
 388 0006 0730     		adds	r0, r0, #7
 389              	.LVL36:
 390              	.L50:
 206:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == code) {
 391              		.loc 1 206 9 is_stmt 1 view .LVU104
 206:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == code) {
 392              		.loc 1 206 12 is_stmt 0 view .LVU105
 393 0008 13F8014F 		ldrb	r4, [r3, #1]!	@ zero_extendqisi2
 394              	.LVL37:
 206:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == code) {
 395              		.loc 1 206 12 view .LVU106
 396 000c 8C42     		cmp	r4, r1
 397              		.loc 1 207 13 is_stmt 1 view .LVU107
 398              		.loc 1 207 38 is_stmt 0 view .LVU108
 399 000e 08BF     		it	eq
 400 0010 1A70     		strbeq	r2, [r3]
 205:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == code) {
 401              		.loc 1 205 52 is_stmt 1 view .LVU109
 402              	.LVL38:
 205:tmk_core/common/report.c ****         if (keyboard_report->keys[i] == code) {
 403              		.loc 1 205 27 view .LVU110
 404 0012 8342     		cmp	r3, r0
 405 0014 F8D1     		bne	.L50
 406              	.LBE7:
 208:tmk_core/common/report.c ****         }
 209:tmk_core/common/report.c ****     }
 210:tmk_core/common/report.c **** #endif
 211:tmk_core/common/report.c **** }
 407              		.loc 1 211 1 is_stmt 0 view .LVU111
 408 0016 10BD     		pop	{r4, pc}
 409              		.cfi_endproc
 410              	.LFE334:
 412              		.section	.rodata.add_key_bit.str1.1,"aMS",%progbits,1
 413              	.LC0:
 414 0000 6164645F 		.ascii	"add_key_bit: can't add: %02X\012\000"
 414      6B65795F 
 414      6269743A 
 414      2063616E 
 414      27742061 
 415              		.section	.text.add_key_bit,"ax",%progbits
 416              		.align	1
 417              		.global	add_key_bit
 418              		.syntax unified
 419              		.thumb
 420              		.thumb_func
 422              	add_key_bit:
 423              	.LVL39:
 424              	.LFB335:
 212:tmk_core/common/report.c **** 
 213:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
 214:tmk_core/common/report.c **** /** \brief add key bit
 215:tmk_core/common/report.c ****  *
 216:tmk_core/common/report.c ****  * FIXME: Needs doc
 217:tmk_core/common/report.c ****  */
 218:tmk_core/common/report.c **** void add_key_bit(report_keyboard_t* keyboard_report, uint8_t code) {
 425              		.loc 1 218 68 is_stmt 1 view -0
 426              		.cfi_startproc
 427              		@ args = 0, pretend = 0, frame = 0
 428              		@ frame_needed = 0, uses_anonymous_args = 0
 429              		@ link register save eliminated.
 219:tmk_core/common/report.c ****     if ((code >> 3) < KEYBOARD_REPORT_BITS) {
 430              		.loc 1 219 5 view .LVU113
 431              		.loc 1 219 8 is_stmt 0 view .LVU114
 432 0000 EF29     		cmp	r1, #239
 433              		.loc 1 219 21 view .LVU115
 434 0002 4FEAD102 		lsr	r2, r1, #3
 435              		.loc 1 219 8 view .LVU116
 436 0006 09D8     		bhi	.L53
 220:tmk_core/common/report.c ****         keyboard_report->nkro.bits[code >> 3] |= 1 << (code & 7);
 437              		.loc 1 220 9 is_stmt 1 view .LVU117
 438              		.loc 1 220 47 is_stmt 0 view .LVU118
 439 0008 1044     		add	r0, r0, r2
 440              	.LVL40:
 441              		.loc 1 220 61 view .LVU119
 442 000a 01F00703 		and	r3, r1, #7
 443              		.loc 1 220 52 view .LVU120
 444 000e 0122     		movs	r2, #1
 445 0010 02FA03F3 		lsl	r3, r2, r3
 446              		.loc 1 220 47 view .LVU121
 447 0014 8278     		ldrb	r2, [r0, #2]	@ zero_extendqisi2
 448 0016 1343     		orrs	r3, r3, r2
 449 0018 8370     		strb	r3, [r0, #2]
 450 001a 7047     		bx	lr
 451              	.LVL41:
 452              	.L53:
 221:tmk_core/common/report.c ****     } else {
 222:tmk_core/common/report.c ****         dprintf("add_key_bit: can't add: %02X\n", code);
 453              		.loc 1 222 9 is_stmt 1 view .LVU122
 454              		.loc 1 222 9 view .LVU123
 455 001c 034B     		ldr	r3, .L58
 456 001e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 457 0020 DB07     		lsls	r3, r3, #31
 458 0022 02D5     		bpl	.L52
 459              	.LVL42:
 460              	.LBB10:
 461              	.LBI10:
 218:tmk_core/common/report.c ****     if ((code >> 3) < KEYBOARD_REPORT_BITS) {
 462              		.loc 1 218 6 view .LVU124
 463              	.LBB11:
 464              		.loc 1 222 9 view .LVU125
 465 0024 0248     		ldr	r0, .L58+4
 466              	.LVL43:
 467              		.loc 1 222 9 is_stmt 0 view .LVU126
 468 0026 FFF7FEBF 		b	printf_
 469              	.LVL44:
 470              	.L52:
 471              		.loc 1 222 9 view .LVU127
 472              	.LBE11:
 473              	.LBE10:
 223:tmk_core/common/report.c ****     }
 224:tmk_core/common/report.c **** }
 474              		.loc 1 224 1 view .LVU128
 475 002a 7047     		bx	lr
 476              	.L59:
 477              		.align	2
 478              	.L58:
 479 002c 00000000 		.word	debug_config
 480 0030 00000000 		.word	.LC0
 481              		.cfi_endproc
 482              	.LFE335:
 484              		.section	.rodata.del_key_bit.str1.1,"aMS",%progbits,1
 485              	.LC1:
 486 0000 64656C5F 		.ascii	"del_key_bit: can't del: %02X\012\000"
 486      6B65795F 
 486      6269743A 
 486      2063616E 
 486      27742064 
 487              		.section	.text.del_key_bit,"ax",%progbits
 488              		.align	1
 489              		.global	del_key_bit
 490              		.syntax unified
 491              		.thumb
 492              		.thumb_func
 494              	del_key_bit:
 495              	.LVL45:
 496              	.LFB336:
 225:tmk_core/common/report.c **** 
 226:tmk_core/common/report.c **** /** \brief del key bit
 227:tmk_core/common/report.c ****  *
 228:tmk_core/common/report.c ****  * FIXME: Needs doc
 229:tmk_core/common/report.c ****  */
 230:tmk_core/common/report.c **** void del_key_bit(report_keyboard_t* keyboard_report, uint8_t code) {
 497              		.loc 1 230 68 is_stmt 1 view -0
 498              		.cfi_startproc
 499              		@ args = 0, pretend = 0, frame = 0
 500              		@ frame_needed = 0, uses_anonymous_args = 0
 501              		@ link register save eliminated.
 231:tmk_core/common/report.c ****     if ((code >> 3) < KEYBOARD_REPORT_BITS) {
 502              		.loc 1 231 5 view .LVU130
 503              		.loc 1 231 8 is_stmt 0 view .LVU131
 504 0000 EF29     		cmp	r1, #239
 505              		.loc 1 231 21 view .LVU132
 506 0002 4FEAD102 		lsr	r2, r1, #3
 507              		.loc 1 231 8 view .LVU133
 508 0006 09D8     		bhi	.L61
 232:tmk_core/common/report.c ****         keyboard_report->nkro.bits[code >> 3] &= ~(1 << (code & 7));
 509              		.loc 1 232 9 is_stmt 1 view .LVU134
 510              		.loc 1 232 47 is_stmt 0 view .LVU135
 511 0008 1044     		add	r0, r0, r2
 512              	.LVL46:
 513              		.loc 1 232 63 view .LVU136
 514 000a 01F00703 		and	r3, r1, #7
 515              		.loc 1 232 54 view .LVU137
 516 000e 0122     		movs	r2, #1
 517 0010 9A40     		lsls	r2, r2, r3
 518              		.loc 1 232 47 view .LVU138
 519 0012 8378     		ldrb	r3, [r0, #2]	@ zero_extendqisi2
 520 0014 23EA0203 		bic	r3, r3, r2
 521 0018 8370     		strb	r3, [r0, #2]
 522 001a 7047     		bx	lr
 523              	.LVL47:
 524              	.L61:
 233:tmk_core/common/report.c ****     } else {
 234:tmk_core/common/report.c ****         dprintf("del_key_bit: can't del: %02X\n", code);
 525              		.loc 1 234 9 is_stmt 1 view .LVU139
 526              		.loc 1 234 9 view .LVU140
 527 001c 034B     		ldr	r3, .L66
 528 001e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 529 0020 DB07     		lsls	r3, r3, #31
 530 0022 02D5     		bpl	.L60
 531              	.LVL48:
 532              	.LBB14:
 533              	.LBI14:
 230:tmk_core/common/report.c ****     if ((code >> 3) < KEYBOARD_REPORT_BITS) {
 534              		.loc 1 230 6 view .LVU141
 535              	.LBB15:
 536              		.loc 1 234 9 view .LVU142
 537 0024 0248     		ldr	r0, .L66+4
 538              	.LVL49:
 539              		.loc 1 234 9 is_stmt 0 view .LVU143
 540 0026 FFF7FEBF 		b	printf_
 541              	.LVL50:
 542              	.L60:
 543              		.loc 1 234 9 view .LVU144
 544              	.LBE15:
 545              	.LBE14:
 235:tmk_core/common/report.c ****     }
 236:tmk_core/common/report.c **** }
 546              		.loc 1 236 1 view .LVU145
 547 002a 7047     		bx	lr
 548              	.L67:
 549              		.align	2
 550              	.L66:
 551 002c 00000000 		.word	debug_config
 552 0030 00000000 		.word	.LC1
 553              		.cfi_endproc
 554              	.LFE336:
 556              		.section	.text.add_key_to_report,"ax",%progbits
 557              		.align	1
 558              		.global	add_key_to_report
 559              		.syntax unified
 560              		.thumb
 561              		.thumb_func
 563              	add_key_to_report:
 564              	.LVL51:
 565              	.LFB337:
 237:tmk_core/common/report.c **** #endif
 238:tmk_core/common/report.c **** 
 239:tmk_core/common/report.c **** /** \brief add key to report
 240:tmk_core/common/report.c ****  *
 241:tmk_core/common/report.c ****  * FIXME: Needs doc
 242:tmk_core/common/report.c ****  */
 243:tmk_core/common/report.c **** void add_key_to_report(report_keyboard_t* keyboard_report, uint8_t key) {
 566              		.loc 1 243 73 is_stmt 1 view -0
 567              		.cfi_startproc
 568              		@ args = 0, pretend = 0, frame = 0
 569              		@ frame_needed = 0, uses_anonymous_args = 0
 570              		@ link register save eliminated.
 244:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
 245:tmk_core/common/report.c ****     if (keyboard_protocol && keymap_config.nkro) {
 571              		.loc 1 245 5 view .LVU147
 243:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
 572              		.loc 1 243 73 is_stmt 0 view .LVU148
 573 0000 10B4     		push	{r4}
 574              		.cfi_def_cfa_offset 4
 575              		.cfi_offset 4, -4
 576              		.loc 1 245 9 view .LVU149
 577 0002 0A4C     		ldr	r4, .L73
 578              		.loc 1 245 8 view .LVU150
 579 0004 2478     		ldrb	r4, [r4]	@ zero_extendqisi2
 243:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
 580              		.loc 1 243 73 view .LVU151
 581 0006 0346     		mov	r3, r0
 582 0008 0A46     		mov	r2, r1
 583              		.loc 1 245 8 view .LVU152
 584 000a 44B1     		cbz	r4, .L69
 585              		.loc 1 245 27 discriminator 1 view .LVU153
 586 000c 084C     		ldr	r4, .L73+4
 587 000e 94F90040 		ldrsb	r4, [r4]
 588 0012 002C     		cmp	r4, #0
 589 0014 03DA     		bge	.L69
 246:tmk_core/common/report.c ****         add_key_bit(keyboard_report, key);
 590              		.loc 1 246 9 is_stmt 1 view .LVU154
 247:tmk_core/common/report.c ****         return;
 248:tmk_core/common/report.c ****     }
 249:tmk_core/common/report.c **** #endif
 250:tmk_core/common/report.c ****     add_key_byte(keyboard_report, key);
 251:tmk_core/common/report.c **** }
 591              		.loc 1 251 1 is_stmt 0 view .LVU155
 592 0016 5DF8044B 		ldr	r4, [sp], #4
 593              		.cfi_remember_state
 594              		.cfi_restore 4
 595              		.cfi_def_cfa_offset 0
 246:tmk_core/common/report.c ****         add_key_bit(keyboard_report, key);
 596              		.loc 1 246 9 view .LVU156
 597 001a FFF7FEBF 		b	add_key_bit
 598              	.LVL52:
 599              	.L69:
 600              		.cfi_restore_state
 250:tmk_core/common/report.c **** }
 601              		.loc 1 250 5 is_stmt 1 view .LVU157
 602              		.loc 1 251 1 is_stmt 0 view .LVU158
 603 001e 5DF8044B 		ldr	r4, [sp], #4
 604              		.cfi_restore 4
 605              		.cfi_def_cfa_offset 0
 250:tmk_core/common/report.c **** }
 606              		.loc 1 250 5 view .LVU159
 607 0022 1146     		mov	r1, r2
 608              	.LVL53:
 250:tmk_core/common/report.c **** }
 609              		.loc 1 250 5 view .LVU160
 610 0024 1846     		mov	r0, r3
 611              	.LVL54:
 250:tmk_core/common/report.c **** }
 612              		.loc 1 250 5 view .LVU161
 613 0026 FFF7FEBF 		b	add_key_byte
 614              	.LVL55:
 615              	.L74:
 250:tmk_core/common/report.c **** }
 616              		.loc 1 250 5 view .LVU162
 617 002a 00BF     		.align	2
 618              	.L73:
 619 002c 00000000 		.word	keyboard_protocol
 620 0030 00000000 		.word	keymap_config
 621              		.cfi_endproc
 622              	.LFE337:
 624              		.section	.text.del_key_from_report,"ax",%progbits
 625              		.align	1
 626              		.global	del_key_from_report
 627              		.syntax unified
 628              		.thumb
 629              		.thumb_func
 631              	del_key_from_report:
 632              	.LVL56:
 633              	.LFB338:
 252:tmk_core/common/report.c **** 
 253:tmk_core/common/report.c **** /** \brief del key from report
 254:tmk_core/common/report.c ****  *
 255:tmk_core/common/report.c ****  * FIXME: Needs doc
 256:tmk_core/common/report.c ****  */
 257:tmk_core/common/report.c **** void del_key_from_report(report_keyboard_t* keyboard_report, uint8_t key) {
 634              		.loc 1 257 75 is_stmt 1 view -0
 635              		.cfi_startproc
 636              		@ args = 0, pretend = 0, frame = 0
 637              		@ frame_needed = 0, uses_anonymous_args = 0
 638              		@ link register save eliminated.
 258:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
 259:tmk_core/common/report.c ****     if (keyboard_protocol && keymap_config.nkro) {
 639              		.loc 1 259 5 view .LVU164
 257:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
 640              		.loc 1 257 75 is_stmt 0 view .LVU165
 641 0000 10B4     		push	{r4}
 642              		.cfi_def_cfa_offset 4
 643              		.cfi_offset 4, -4
 644              		.loc 1 259 9 view .LVU166
 645 0002 0A4C     		ldr	r4, .L80
 646              		.loc 1 259 8 view .LVU167
 647 0004 2478     		ldrb	r4, [r4]	@ zero_extendqisi2
 257:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
 648              		.loc 1 257 75 view .LVU168
 649 0006 0346     		mov	r3, r0
 650 0008 0A46     		mov	r2, r1
 651              		.loc 1 259 8 view .LVU169
 652 000a 44B1     		cbz	r4, .L76
 653              		.loc 1 259 27 discriminator 1 view .LVU170
 654 000c 084C     		ldr	r4, .L80+4
 655 000e 94F90040 		ldrsb	r4, [r4]
 656 0012 002C     		cmp	r4, #0
 657 0014 03DA     		bge	.L76
 260:tmk_core/common/report.c ****         del_key_bit(keyboard_report, key);
 658              		.loc 1 260 9 is_stmt 1 view .LVU171
 261:tmk_core/common/report.c ****         return;
 262:tmk_core/common/report.c ****     }
 263:tmk_core/common/report.c **** #endif
 264:tmk_core/common/report.c ****     del_key_byte(keyboard_report, key);
 265:tmk_core/common/report.c **** }
 659              		.loc 1 265 1 is_stmt 0 view .LVU172
 660 0016 5DF8044B 		ldr	r4, [sp], #4
 661              		.cfi_remember_state
 662              		.cfi_restore 4
 663              		.cfi_def_cfa_offset 0
 260:tmk_core/common/report.c ****         del_key_bit(keyboard_report, key);
 664              		.loc 1 260 9 view .LVU173
 665 001a FFF7FEBF 		b	del_key_bit
 666              	.LVL57:
 667              	.L76:
 668              		.cfi_restore_state
 264:tmk_core/common/report.c **** }
 669              		.loc 1 264 5 is_stmt 1 view .LVU174
 670              		.loc 1 265 1 is_stmt 0 view .LVU175
 671 001e 5DF8044B 		ldr	r4, [sp], #4
 672              		.cfi_restore 4
 673              		.cfi_def_cfa_offset 0
 264:tmk_core/common/report.c **** }
 674              		.loc 1 264 5 view .LVU176
 675 0022 1146     		mov	r1, r2
 676              	.LVL58:
 264:tmk_core/common/report.c **** }
 677              		.loc 1 264 5 view .LVU177
 678 0024 1846     		mov	r0, r3
 679              	.LVL59:
 264:tmk_core/common/report.c **** }
 680              		.loc 1 264 5 view .LVU178
 681 0026 FFF7FEBF 		b	del_key_byte
 682              	.LVL60:
 683              	.L81:
 264:tmk_core/common/report.c **** }
 684              		.loc 1 264 5 view .LVU179
 685 002a 00BF     		.align	2
 686              	.L80:
 687 002c 00000000 		.word	keyboard_protocol
 688 0030 00000000 		.word	keymap_config
 689              		.cfi_endproc
 690              	.LFE338:
 692              		.section	.text.clear_keys_from_report,"ax",%progbits
 693              		.align	1
 694              		.global	clear_keys_from_report
 695              		.syntax unified
 696              		.thumb
 697              		.thumb_func
 699              	clear_keys_from_report:
 700              	.LVL61:
 701              	.LFB339:
 266:tmk_core/common/report.c **** 
 267:tmk_core/common/report.c **** /** \brief clear key from report
 268:tmk_core/common/report.c ****  *
 269:tmk_core/common/report.c ****  * FIXME: Needs doc
 270:tmk_core/common/report.c ****  */
 271:tmk_core/common/report.c **** void clear_keys_from_report(report_keyboard_t* keyboard_report) {
 702              		.loc 1 271 65 is_stmt 1 view -0
 703              		.cfi_startproc
 704              		@ args = 0, pretend = 0, frame = 0
 705              		@ frame_needed = 0, uses_anonymous_args = 0
 706              		@ link register save eliminated.
 272:tmk_core/common/report.c ****     // not clear mods
 273:tmk_core/common/report.c **** #ifdef NKRO_ENABLE
 274:tmk_core/common/report.c ****     if (keyboard_protocol && keymap_config.nkro) {
 707              		.loc 1 274 5 view .LVU181
 708              		.loc 1 274 9 is_stmt 0 view .LVU182
 709 0000 094A     		ldr	r2, .L87
 710              		.loc 1 274 8 view .LVU183
 711 0002 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 271:tmk_core/common/report.c ****     // not clear mods
 712              		.loc 1 271 65 view .LVU184
 713 0004 0346     		mov	r3, r0
 275:tmk_core/common/report.c ****         memset(keyboard_report->nkro.bits, 0, sizeof(keyboard_report->nkro.bits));
 714              		.loc 1 275 37 view .LVU185
 715 0006 0230     		adds	r0, r0, #2
 716              	.LVL62:
 274:tmk_core/common/report.c ****         memset(keyboard_report->nkro.bits, 0, sizeof(keyboard_report->nkro.bits));
 717              		.loc 1 274 8 view .LVU186
 718 0008 42B1     		cbz	r2, .L83
 274:tmk_core/common/report.c ****         memset(keyboard_report->nkro.bits, 0, sizeof(keyboard_report->nkro.bits));
 719              		.loc 1 274 27 discriminator 1 view .LVU187
 720 000a 084A     		ldr	r2, .L87+4
 721 000c 92F90020 		ldrsb	r2, [r2]
 722 0010 002A     		cmp	r2, #0
 723 0012 03DA     		bge	.L83
 724              		.loc 1 275 9 is_stmt 1 view .LVU188
 725 0014 1E22     		movs	r2, #30
 726 0016 0021     		movs	r1, #0
 727 0018 FFF7FEBF 		b	memset
 728              	.LVL63:
 729              	.L83:
 276:tmk_core/common/report.c ****         return;
 277:tmk_core/common/report.c ****     }
 278:tmk_core/common/report.c **** #endif
 279:tmk_core/common/report.c ****     memset(keyboard_report->keys, 0, sizeof(keyboard_report->keys));
 730              		.loc 1 279 5 view .LVU189
 731 001c 0022     		movs	r2, #0
 732 001e C3F80220 		str	r2, [r3, #2]	@ unaligned
 733 0022 8280     		strh	r2, [r0, #4]	@ unaligned
 280:tmk_core/common/report.c **** }
 734              		.loc 1 280 1 is_stmt 0 view .LVU190
 735 0024 7047     		bx	lr
 736              	.L88:
 737 0026 00BF     		.align	2
 738              	.L87:
 739 0028 00000000 		.word	keyboard_protocol
 740 002c 00000000 		.word	keymap_config
 741              		.cfi_endproc
 742              	.LFE339:
 744              		.text
 745              	.Letext0:
 746              		.file 2 "/usr/arm-none-eabi/include/machine/_default_types.h"
 747              		.file 3 "/usr/arm-none-eabi/include/sys/_stdint.h"
 748              		.file 4 "/usr/lib/gcc/arm-none-eabi/12.2.0/include/stddef.h"
 749              		.file 5 "tmk_core/common/report.h"
 750              		.file 6 "quantum/keycode_config.h"
 751              		.file 7 "tmk_core/common/host.h"
 752              		.file 8 "quantum/logging/debug.h"
 753              		.file 9 "/usr/arm-none-eabi/include/string.h"
 754              		.file 10 "lib/printf/printf.h"
 755              		.file 11 "quantum/bitwise.h"
 756              		.file 12 "quantum/keycode.h"
 757              		.file 13 "<built-in>"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 report.c
     /tmp/cc1RZNAq.s:21     .text.has_anykey:0000000000000000 $t
     /tmp/cc1RZNAq.s:27     .text.has_anykey:0000000000000000 has_anykey
     /tmp/cc1RZNAq.s:97     .text.has_anykey:0000000000000030 $d
     /tmp/cc1RZNAq.s:103    .text.get_first_key:0000000000000000 $t
     /tmp/cc1RZNAq.s:109    .text.get_first_key:0000000000000000 get_first_key
     /tmp/cc1RZNAq.s:185    .text.get_first_key:000000000000003c $d
     /tmp/cc1RZNAq.s:191    .text.is_key_pressed:0000000000000000 $t
     /tmp/cc1RZNAq.s:197    .text.is_key_pressed:0000000000000000 is_key_pressed
     /tmp/cc1RZNAq.s:284    .text.is_key_pressed:0000000000000048 $d
     /tmp/cc1RZNAq.s:290    .text.add_key_byte:0000000000000000 $t
     /tmp/cc1RZNAq.s:296    .text.add_key_byte:0000000000000000 add_key_byte
     /tmp/cc1RZNAq.s:361    .text.del_key_byte:0000000000000000 $t
     /tmp/cc1RZNAq.s:367    .text.del_key_byte:0000000000000000 del_key_byte
     /tmp/cc1RZNAq.s:416    .text.add_key_bit:0000000000000000 $t
     /tmp/cc1RZNAq.s:422    .text.add_key_bit:0000000000000000 add_key_bit
     /tmp/cc1RZNAq.s:479    .text.add_key_bit:000000000000002c $d
     /tmp/cc1RZNAq.s:488    .text.del_key_bit:0000000000000000 $t
     /tmp/cc1RZNAq.s:494    .text.del_key_bit:0000000000000000 del_key_bit
     /tmp/cc1RZNAq.s:551    .text.del_key_bit:000000000000002c $d
     /tmp/cc1RZNAq.s:557    .text.add_key_to_report:0000000000000000 $t
     /tmp/cc1RZNAq.s:563    .text.add_key_to_report:0000000000000000 add_key_to_report
     /tmp/cc1RZNAq.s:619    .text.add_key_to_report:000000000000002c $d
     /tmp/cc1RZNAq.s:625    .text.del_key_from_report:0000000000000000 $t
     /tmp/cc1RZNAq.s:631    .text.del_key_from_report:0000000000000000 del_key_from_report
     /tmp/cc1RZNAq.s:687    .text.del_key_from_report:000000000000002c $d
     /tmp/cc1RZNAq.s:693    .text.clear_keys_from_report:0000000000000000 $t
     /tmp/cc1RZNAq.s:699    .text.clear_keys_from_report:0000000000000000 clear_keys_from_report
     /tmp/cc1RZNAq.s:739    .text.clear_keys_from_report:0000000000000028 $d

UNDEFINED SYMBOLS
keyboard_protocol
keymap_config
biton
printf_
debug_config
memset
